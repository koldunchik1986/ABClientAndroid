
### 1. План портирования ErrorForm.cs

Файл `ErrorForm.cs` (несмотря на то, что класс внутри ошибочно назван `FormAutoTrap`) представляет собой форму для отображения информации о необработанном исключении.

### 2. Функциональность в C#

- **Назначение:** Показать пользователю полный текст ошибки в текстовом поле, чтобы его можно было скопировать и отправить разработчику.
- **UI:** Содержит многострочное, нередактируемое текстовое поле (`TextBox`), кнопку "Продолжить" для закрытия и метку с инструкциями.
- **Логика:** Принимает строку с исключением в конструкторе и отображает ее.

### 3. Решение для портирования на Android

Для отображения ошибок в Android используется `AlertDialog`. Для глобального отлова ошибок — `Thread.UncaughtExceptionHandler`.

- **UI:** Вместо формы будет использоваться `AlertDialog` с кастомным макетом, содержащим `ScrollView` и `TextView` для прокручиваемого текста ошибки.
- **Функциональность:** Диалог должен предоставлять кнопки для копирования текста ошибки и закрытия окна.

### 4. План реализации

1.  **Создать макет `dialog_error.xml`:**
    - В макете разместить `ScrollView`, а внутри него — `TextView` для текста ошибки.
2.  **Создать утилитарную функцию `ErrorDialogUtils.kt`:**
    - Создать в ней функцию `fun showErrorDialog(context: Context, errorText: String)`.
    - Внутри этой функции:
        - Создать `AlertDialog.Builder`.
        - Установить заголовок и сообщение.
        - Установить кастомный макет (`dialog_error.xml`) и найти в нем `TextView`, чтобы задать `errorText`.
        - Добавить кнопку "Копировать":
          - По нажатию получать `ClipboardManager`.
          - Копировать `errorText` в буфер обмена.
          - Показывать `Toast` с сообщением "Текст скопирован".
        - Добавить кнопку "Закрыть", которая просто закрывает диалог.
        - Показать созданный диалог.
3.  **Реализовать глобальный обработчик исключений:**
    - Создать класс `MyUncaughtExceptionHandler`, реализующий `Thread.UncaughtExceptionHandler`.
    - В методе `uncaughtException`:
        - Преобразовать `Throwable` в строку (stack trace).
        - **Важно:** Сначала записать ошибку в локальный файл лога.
        - Запустить `Activity`, которая покажет `showErrorDialog`.
    - В классе `Application` установить этот обработчик: `Thread.setDefaultUncaughtExceptionHandler(MyUncaughtExceptionHandler())`.

- [ ] Создать макет `dialog_error.xml`.
- [ ] Создать утилиту `ErrorDialogUtils.kt` с функцией `showErrorDialog`.
- [ ] Реализовать копирование в буфер обмена.
- [ ] Создать и установить глобальный обработчик исключений `MyUncaughtExceptionHandler`.
