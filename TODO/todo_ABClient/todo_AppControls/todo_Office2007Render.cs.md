# План портирования Office2007Render.cs

Файл `Office2007Render.cs` - это сложнейший класс для кастомной отрисовки UI, имитирующей стиль MS Office 2007.

## Функциональность в C#

*   **Назначение**: Полностью переопределить стандартную отрисовку `ToolStrip`, `MenuStrip`, `ContextMenuStrip` и `StatusStrip`, чтобы они выглядели как в Office 2007.
*   **Реализация**: Наследуется от `ToolStripProfessionalRenderer` и переопределяет практически все методы `OnRender...`. Внутри каждого метода содержится низкоуровневый GDI+ код, который вручную рисует градиенты, границы, стрелки, галочки и другие элементы для всех возможных состояний контрола (нажат, выбран, недоступен).

## Проверка на существующую реализацию в Android

- **Результат:** Неприменимо. Функциональность на 100% специфична для `System.Windows.Forms`.
- **Объяснение**: Этот класс невозможно портировать. В Android вся стилизация и отрисовка компонентов UI делается совершенно иначе.

## Решение для портирования на Android

Задача "воссоздать стиль Office 2007" в Android решается не портированием этого класса, а созданием Android-темы.

1.  **Определение Цветов**: Все цвета из `Office2007ColorTable` и `Office2007Render` должны быть определены в `res/values/colors.xml`.
2.  **Создание Drawable Ресурсов**: Для каждого состояния кнопок, меню и других элементов нужно создать XML-файлы в `res/drawable/`. Это будут `shape` с градиентами и `selector`, который указывает, какой `shape` использовать для какого состояния (`state_pressed`, `state_selected` и т.д.).
3.  **Создание Стилей**: В `res/values/styles.xml` нужно создать стили для `Toolbar`, `PopupMenu`, `Button` и других виджетов, применяя к ним созданные `drawable` ресурсы и цвета.
4.  **Применение Темы**: Все стили объединяются в одну общую тему в `themes.xml`, которая затем применяется ко всему приложению или к отдельным `Activity` в `AndroidManifest.xml`.

## План реализации

- [x] **Задача решена.** Функциональность кастомной отрисовки в Android реализуется через систему тем и стилей в XML.
- [ ] **Обновить `todo_AppControls.md`**, отметив `Office2007Render.cs` как проанализированный и не требующий портирования (`[+]`).
