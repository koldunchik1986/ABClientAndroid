
### 1. План портирования MainPhpDrink.cs

Файл `MainPhpDrink.cs` содержит набор статических методов для парсинга и модификации ответа от `main.php`. Основная задача - автоматизация различных действий, таких как навигация, использование предметов и способностей.

### 2. Функциональность в C#

Этот файл содержит множество методов. Метод, соответствующий названию файла - `MainPhpFindDrink`.

- **Назначение `MainPhpFindDrink`:** Найти на странице возможность "Пить" и внедрить javascript-код для автоматизации этого действия.
- **Логика `MainPhpFindDrink`:**
    1.  Ищет в HTML-коде страницы javascript-массив, содержащий информацию о действии "Пить" (`["dri","Пить","vcode",[]]`).
    2.  Извлекает из этого массива `vcode` (код проверки).
    3.  Формирует javascript-вызов `Drink('{vcode}');`.
    4.  Находит на странице вызов `view_map();` и вставляет после него сформированный вызов `Drink`.
    5.  Это позволяет клиентскому приложению перехватить и обработать действие "Пить".

- **Другие методы в файле:**
    - `MainPhpFindFlora`: Поиск кнопки "Вернуться" для перехода на природу.
    - `MainPhpFindInv`, `MainPhpFindInvOld`, `MainPhpIsInv`: Поиск кнопки "Инвентарь" и проверка, открыт ли инвентарь.
    - `MainPhpFindPerc`, `MainPhpIsPerc`: Поиск кнопки "Ваш персонаж" и проверка, открыт ли он.
    - `MainPhpFindEnter`: Поиск кнопки "Войти".
    - `MainPhpFindFish`: Поиск кнопки "Рыбалка" и внедрение javascript-вызова `Fish()`.
    - `MainPhpIsA`: Проверка наличия определенной ссылки.

### 3. Решение для портирования на Android

Логика этих методов должна быть реализована на стороне Android-приложения. Это не классические фильтры, а часть движка автоматизации.

### 4. План реализации

1.  **Создать класс `MainPhpParser` в Android:**
    - Этот класс будет содержать статические методы для анализа HTML-кода `main.php`.
2.  **Реализовать `findDrinkAction`:**
    - Метод будет принимать HTML-код и возвращать объект `Action` (или `null`), содержащий `vcode` для действия "Пить".
3.  **Создать `JavascriptInterface` для действий:**
    - Создать `WebAppInterface` с методами `drink(vcode)` и `fish(vcode)`.
4.  **Внедрение Javascript:**
    - Вместо модификации HTML, можно внедрить небольшой скрипт, который будет вызывать методы `WebAppInterface` при обнаружении соответствующих действий на странице.

- [ ] Создать класс `MainPhpParser`.
- [ ] Реализовать в `MainPhpParser` методы для извлечения `vcode` для различных действий.
- [ ] Создать `WebAppInterface` с методами для выполнения действий.
- [ ] Разработать стратегию по внедрению javascript для вызова методов `WebAppInterface`.
