
### 1. План портирования TeleportAjax.cs

Файл `TeleportAjax.cs` не является классическим фильтром. Это часть логики автоматического передвижения по карте (автонавигатора), которая срабатывает после выполнения телепортации.

### 2. Функциональность в C#

- **Назначение:** Обработать результат телепортации и определить следующий шаг в автоматическом маршруте.
- **Логика:**
    1. Проверяет, существует ли и актуален ли путь автонавигатора (`AppVars.AutoMovingMapPath`). Если нет, строит новый путь до цели (`AppVars.AutoMovingDestinaton`).
    2. Определяет следующий прыжок (`AutoMovingNextJump`) в маршруте.
    3. Если прыжков больше нет (цель достигнута), отключает навигатор (`AppVars.MainForm.NavigatorOffInvoke`).
    4. Парсит javascript-переменную `telep`, содержащую массив доступных для телепортации локаций.
    5. Ищет в этом массиве локацию, которая соответствует следующему прыжку в маршруте (`AppVars.AutoMovingNextJump`).
    6. Если нужная локация найдена, генерирует HTML-код с редиректом на URL этой телепортации.
    7. Если нужная локация не найдена, пытается найти ссылку для выхода из здания телепорта и генерирует редирект на нее.
    8. Если ничего не найдено, возвращает `null`.

### 3. Решение для портирования на Android

Эта логика тесно связана с состоянием приложения в C# (`AppVars`, `MapPath`, `Map.Location` и т.д.). Прямое портирование в виде javascript-фильтра невозможно. Функциональность должна быть полностью переписана на стороне Android-приложения.

### 4. План реализации

1.  **Создать класс `AutoNavigator` в Android:**
    - Этот класс будет отвечать за управление состоянием автонавигации (текущий маршрут, следующая точка, цель).
2.  **Реализовать обработку ответа от сервера:**
    - После каждого действия (переход по локации, телепорт) анализировать ответ сервера.
    - Если ответ содержит `teleport_ajax.php`, то это означает, что персонаж находится в телепорте.
    - В этом случае, `AutoNavigator` должен:
        - Получить из ответа доступные точки для телепортации.
        - Сравнить их со следующей точкой в своем маршруте.
        - Сформировать и выполнить следующий запрос к серверу для телепортации в нужную точку или выхода из телепорта.
3.  **Интеграция с WebView:**
    - Логика `AutoNavigator` будет вызываться из `WebViewClient` при загрузке определенных URL.

- [ ] Создать класс `AutoNavigator` для управления состоянием автонавигации.
- [ ] Реализовать в `WebViewClient` перехват ответов от сервера, содержащих `teleport_ajax.php`.
- [ ] Реализовать логику парсинга доступных телепортов и принятия решения о следующем шаге.
- [ ] Реализовать формирование и выполнение запроса для следующего шага.
