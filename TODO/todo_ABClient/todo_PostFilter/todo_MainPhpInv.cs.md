
### 1. План портирования MainPhpInv.cs

Файл `MainPhpInv.cs` содержит сложную логику для модификации и автоматизации действий на странице инвентаря.

### 2. Функциональность в C#

- **Назначение:** Улучшение и автоматизация управления инвентарем.
- **Логика:**
    1.  **Парсинг инвентаря:** Код итерирует по HTML-коду страницы, извлекая каждый предмет и создавая для него объект `InvEntry`.
    2.  **Автоматическое выбрасывание/продажа:**
        *   **Выбрасывание (`BulkDrop`):** Если активна задача на массовое выбрасывание (`AppVars.BulkDropThing`), и текущий предмет совпадает с целью, генерируется редирект на ссылку для выбрасывания этого предмета.
        *   **Продажа (`BulkSell`):** Если активна задача на массовую продажу (`AppVars.BulkSellThing`), и текущий предмет совпадает с целью, генерируется редирект на ссылку для продажи.
    3.  **Завершение авто-действий:** После парсинга всех предметов, если авто-действие было в процессе, в чат отправляется сообщение о его завершении.
    4.  **Группировка предметов (`DoInvPack`):** Если включена опция, код находит одинаковые предметы и объединяет их в одну запись, увеличивая счетчик количества.
    5.  **Добавление кнопок:** В HTML-код каждого предмета добавляются кнопки "Массовая продажа" и "Массовый выброс".
    6.  **Сортировка (`DoInvSort`):** Если включена опция, инвентарь сортируется по определенным правилам с помощью `InvComparer`.
    7.  **Пересборка HTML:** После всех модификаций, HTML-код инвентаря генерируется заново и возвращается для отображения.

### 3. Решение для портирования на Android

Это одна из ключевых функций клиента, которая требует полной переработки на стороне Android. Прямое портирование невозможно.

### 4. План реализации

1.  **Создать класс `InventoryManager` в Android:**
    - Будет управлять состоянием инвентаря, настройками и выполнением действий.
2.  **Создать класс `InventoryItem`:**
    - Аналог `InvEntry`. Будет представлять один предмет в инвентаре.
3.  **Создать `InventoryParser`:**
    - Будет отвечать за парсинг HTML-кода инвентаря и создание списка объектов `InventoryItem`.
4.  **Интеграция с `WebViewClient`:**
    - `WebViewClient` будет перехватывать страницу инвентаря и передавать ее HTML в `InventoryParser`.
    - `InventoryManager` будет получать список предметов.
5.  **Реализация логики в `InventoryManager`:**
    - Реализовать логику автоматической продажи/выбрасывания.
    - Реализовать логику группировки и сортировки.
6.  **Отображение:**
    - Вместо модификации HTML, использовать `RecyclerView` для отображения инвентаря. Это даст гораздо лучший пользовательский опыт и производительность.
    - Каждый `InventoryItem` будет элементом `RecyclerView`.
    - Кнопки "Продать", "Выбросить", "Массовая продажа" будут нативными кнопками Android.

- [ ] Создать классы `InventoryManager`, `InventoryItem`, `InventoryParser`.
- [ ] Интегрировать парсер с `WebViewClient`.
- [ ] Реализовать логику управления инвентарем в `InventoryManager`.
- [ ] Создать UI на базе `RecyclerView` для отображения инвентаря.
