# План портирования GamePhp.cs

Файл `GamePhp.cs` - это часть `partial` класса `Filter`, отвечающая за обработку страницы `game.php`, которая является основной страницей-фреймсетом после входа в игру.

## Функциональность в C#

*   **Назначение**: Обработать страницу `game.php`, в основном для автоматического ввода "флеш-пароля", если это требуется.
*   **Логика**: 
    1.  Проверяет флаг `AppVars.WaitFlash`, который устанавливается после успешного основного логина.
    2.  Если флаг `true` и у пользователя задан флеш-пароль, фильтр парсит `plid` со страницы.
    3.  Затем он генерирует с нуля новую HTML-страницу со скрытой формой, подставляет в нее `plid` и флеш-пароль и автоматически отправляет эту форму с помощью JavaScript.
    4.  Сбрасывает флаг `AppVars.WaitFlash`.

## Проверка на существующую реализацию в Android

- **Результат:** Функциональность реализована и расширена.
- **Объяснение**:
    1.  В проекте существует класс `app/src/main/java/ru/neverlands/abclient/postfilter/GamePhp.java`.
    2.  Логика проверки `AppVars.WaitFlash` и автоматической отправки формы с флеш-паролем полностью портирована.
    3.  **Дополнительная функциональность**: В Java-версии добавлен важный метод `parseFrames`, который с помощью регулярных выражений парсит страницу-фреймсет, извлекает URL-адреса всех фреймов (`main_top`, `chmain`, `ch_list` и т.д.) и сохраняет их в `AppVars`. Это ключевая логика для работы много-фреймового интерфейса в Android.
    4.  **Отличие**: После обработки, Java-версия возвращает пустую страницу, в то время как C#-версия возвращала модифицированную. Это логично, так как после получения URL-адресов фреймов, основная страница больше не нужна, а ее контент будет загружен в отдельные `WebView`.

## Решение для портирования на Android

Никаких действий не требуется. Существующая реализация является полной и правильной для архитектуры Android-приложения.

## План реализации

- [x] **Задача решена.** Функциональность уже существует.
- [ ] **Обновить `todo_PostFilter.md`**, отметив `GamePhp.cs` как проанализированный и реализованный (`[+]`).
