
### 1. План портирования MainPhpCure.cs

Файл `MainPhpCure.cs` является частью логики автоматизации, а именно - автоматического лечения травм. Он не фильтрует, а генерирует HTML-страницу с формой для автоматического использования аптечки на другом персонаже.

### 2. Функциональность в C#

- **Назначение:** Автоматически вылечить травму указанному персонажу.
- **Логика:**
    1.  Проверяет, есть ли активная задача на лечение (`AppVars.CureTravm`) и какой тип травмы нужно лечить.
    2.  Парсит HTML-код страницы `main.php` в поисках javascript-вызовов функции `doctorform(...)`.
    3.  Находит вызов `doctorform`, который соответствует нужному типу травмы.
    4.  Извлекает из аргументов этого вызова все необходимые параметры для лечения (`duid`, `vcode`, `dprice`, `dtype`, `dcurs`).
    5.  Генерирует новую HTML-страницу, содержащую скрытую форму (`<form>`).
    6.  В эту форму подставляются все извлеченные параметры, а также ник персонажа, которого нужно вылечить (`AppVars.CureNick`).
    7.  В конец страницы добавляется javascript-код (`document.ff.submit();`), который автоматически отправляет эту форму.
    8.  Возвращает сгенерированную HTML-страницу, которая, будучи загруженной в браузер, немедленно выполняет лечение.

### 3. Решение для портирования на Android

Эта логика тесно связана с состоянием C# приложения (`AppVars`). Прямое портирование невозможно. Функциональность должна быть переписана на стороне Android-приложения.

### 4. План реализации

1.  **Создать класс `AutoCureManager` в Android:**
    - Этот класс будет управлять состоянием авто-лечения (какую травму лечить, какого персонажа).
2.  **Реализовать обработку ответа от сервера:**
    - В `WebViewClient` перехватывать загрузку `main.php`.
    - Если `AutoCureManager` активен, передавать HTML-содержимое страницы в него для анализа.
3.  **Реализовать логику анализа в `AutoCureManager`:**
    - Воспроизвести логику парсинга вызовов `doctorform`.
    - Найти нужный вызов и извлечь параметры.
4.  **Выполнение действия:**
    - `AutoCureManager` должен сформировать `POST`-запрос на `main.php` со всеми необходимыми параметрами, эмулируя отправку формы.
    - Выполнить этот запрос с помощью `WebView.postUrl()` или другой сетевой библиотеки.

- [ ] Создать класс `AutoCureManager`.
- [ ] Реализовать в `WebViewClient` перехват и передачу HTML-кода в `AutoCureManager`.
- [ ] Реализовать в `AutoCureManager` логику парсинга и извлечения параметров.
- [ ] Реализовать формирование и выполнение `POST`-запроса для лечения.
