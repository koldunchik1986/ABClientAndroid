
### 1. План портирования NeuroBase.cs

Файл `NeuroBase.cs` является ядром самописного движка для распознавания символов (OCR), который, судя по всему, используется для решения CAPTCHA в игре (Guamod).

### 2. Функциональность в C#

- **Назначение:** Распознать последовательность символов из растрового изображения (`Bitmap`).
- **Принцип работы:**
    1.  **Загрузка данных:** Загружает обученную базу векторов (`NeuroVector`) из сжатого GZip-файла `abneuro.dat`.
    2.  **Обработка изображения (`Calculate`):**
        - **Бинаризация:** Преобразует изображение в черно-белое по пороговому значению яркости.
        - **Сегментация:** Делит изображение на 5 вертикальных сегментов, предполагая, что в каждом находится один символ.
        - **Нормализация:** Каждый сегмент обрезается и масштабируется до стандартного размера 10x10 пикселей.
        - **Векторизация:** Преобразует картинку 10x10 в вектор из 100 `double` значений (яркость пикселей).
    3.  **Распознавание (`FindVector`):**
        - Для каждого полученного вектора ищет ближайший вектор в загруженной базе данных, используя евклидово расстояние (алгоритм K-ближайших соседей, где k=1).
        - Возвращает символ (`Token`), связанный с найденным ближайшим вектором из базы.

### 3. Решение для портирования на Android

Прямое портирование этого движка — сложная и неблагодарная задача. Код тесно связан с `System.Drawing` и реализует примитивный OCR, который будет сильно уступать современным библиотекам по точности и скорости. **Настоятельно рекомендуется не портировать этот класс, а заменить его современной OCR-библиотекой.**

- **Рекомендуемый подход:** Использовать **Google ML Kit Text Recognition**.
    - Это стандартная, мощная и оптимизированная библиотека для распознавания текста на Android.
    - Она значительно превосходит самописный движок по точности, устойчивости к шумам, шрифтам и поворотам.

### 4. План реализации (с использованием ML Kit)

1.  **Отказаться от `NeuroBase`, `NeuroVector` и `abneuro.dat`:** Эти файлы и их логика больше не понадобятся.
2.  **Интегрировать Google ML Kit:**
    - Добавить зависимость `com.google.android.gms:play-services-mlkit-text-recognition` в `build.gradle`.
3.  **Создать `CaptchaRecognizer.kt`:**
    - Создать класс-синглтон, который будет инкапсулировать логику распознавания.
    - Метод `recognize(bitmap: Bitmap): String` будет принимать на вход `Bitmap` с капчей.
    - Внутри метода:
        - Создать `InputImage.fromBitmap(bitmap, 0)`.
        - Получить экземпляр `TextRecognition.getClient(TextRecognizerOptions.DEFAULT_OPTIONS)`.
        - Вызвать `process(image)` и в слушателе `onSuccess` обработать результат.
        - Извлечь распознанный текст из `Text` объекта, отфильтровать лишние символы и вернуть готовую строку.
4.  **Обновить `Guamod`:**
    - Класс, отвечающий за решение капчи (вероятно, `MyGuamod/Recognizer.cs`), должен будет вызывать новый `CaptchaRecognizer` вместо `NeuroBase`.

Этот подход заменяет устаревший и хрупкий самописный OCR на мощное и поддерживаемое решение, что повысит надежность и точность функции.

- [ ] Добавить зависимость ML Kit Text Recognition.
- [ ] Создать класс `CaptchaRecognizer` для инкапсуляции логики ML Kit.
- [ ] Заменить вызовы `NeuroBase` на вызовы `CaptchaRecognizer`.
