# Общий анализ папки MyGuamod

Папка `MyGuamod` содержит класс `Recognizer.cs`, который отвечает за автоматическое распознавание капчи (гуамода).

## Функциональность в C#

1.  **Инициализация**: При первом вызове, метод `PrepareData` загружает из ресурсов файл `abneuro` и инициализирует им нейросеть, реализованную в классе `NeuroBase`.
2.  **Распознавание**: Процесс запускается в фоновом потоке.
    *   Он ожидает появления изображения капчи в глобальной переменной `AppVars.CodePng`.
    *   Изображение передается в экземпляр `NeuroBase`.
    *   Нейросеть обрабатывает изображение и возвращает распознанный код в виде строки.
3.  **Применение результата**:
    *   Если код распознан с достаточной уверенностью, он подставляется в ссылку для входа в бой.
    *   Если уверенность низкая, автобой отключается, и страница обновляется для получения новой капчи.

## Зависимости

*   **`Neuro/NeuroBase.cs`**: Критически зависит от этого класса, где реализована вся математика нейронной сети.
*   **`abneuro`**: Файл с весами и архитектурой нейросети.

## План портирования на Android

**Статус: ОЧЕНЬ СЛОЖНЫЙ. ВЫСОКИЙ РИСК.** Это самая сложная для портирования часть всего проекта. Прямой перенос математики нейросети на Java будет крайне трудоемким и неэффективным. Правильный подход — использовать современные фреймворки для машинного обучения.

**Рекомендуемый план (требует экспертизы в ML):**

### Этап 1: Анализ и конвертация модели

1.  **Анализ `NeuroBase.cs`**: Необходимо глубоко проанализировать этот класс, чтобы понять архитектуру нейросети: тип (вероятно, простой перцептрон), количество слоев, количество нейронов в каждом слое, используемые функции активации.
2.  **Анализ `abneuro`**: Необходимо понять формат этого файла, чтобы извлечь из него веса нейросети (матрицы весов для каждого слоя).
3.  **Воссоздание и конвертация**: 
    *   Используя Python и библиотеки, такие как `TensorFlow` или `PyTorch`, создать нейросеть с такой же архитектурой.
    *   Загрузить в нее веса, извлеченные на предыдущем шаге.
    *   Сохранить эту модель в формате **TensorFlow Lite (`.tflite`)**. Это стандартный формат для запуска нейросетей на мобильных устройствах.

### Этап 2: Интеграция в Android-приложение

1.  **Добавить зависимость**: В `build.gradle` добавить `implementation 'org.tensorflow:tensorflow-lite:2.9.0'`.
2.  **Добавить модель**: Поместить полученный на этапе 1 файл `model.tflite` в папку `app/src/main/assets/`.
3.  **Создать `CaptchaRecognizer.java`**:
    *   **Загрузка модели**: Написать код для загрузки `.tflite` файла и инициализации `org.tensorflow.lite.Interpreter`.
    *   **Предобработка изображения**: Написать функцию, которая будет принимать `Bitmap` с капчей и преобразовывать его в формат, понятный нейросети (`ByteBuffer`). Это включает: преобразование в оттенки серого, бинаризацию (черный/белый), нормализацию значений пикселей и изменение размера до того, который ожидает на вход модель.
    *   **Выполнение распознавания**: Вызвать `interpreter.run(inputBuffer, outputBuffer)`.
    *   **Постобработка**: Написать функцию, которая будет интерпретировать `outputBuffer` (массив вероятностей для каждой цифры) и формировать из него итоговую строку с распознанным кодом.

Этот подход позволит использовать оптимизированный для мобильных устройств движок TensorFlow Lite вместо ручного портирования сложной математики.
