# План портирования TopJs.cs

Файл `TopJs.cs` является частью `PostFilter` и предназначен для модификации скрипта `top.js`.

## Функциональность в C#

Фильтр выполняет очень специфичную замену:

*   **Находит**: Первое вхождение пустых скобок `()` в файле, что обычно соответствует объявлению функции без аргументов, например, `function some_function() { ... }`.
*   **Заменяет**: Тело этой функции на ` { return ''; }`.

**Назначение:**

Вероятнее всего, в оригинальном файле `top.js` была некая функция, которая генерировала нежелательный HTML-контент (например, рекламный баннер, счетчик, ненужную ссылку). Заменив ее тело на возврат пустой строки, разработчик клиента эффективно "вырезал" этот контент со страницы, не ломая при этом другие скрипты, которые могли бы вызывать эту функцию.

## План портирования в Android

Это простое и безопасное изменение, которое следует сохранить для поддержания консистентности с оригинальным клиентом.

1.  **Создать `TopJs.java`**: В пакете `ru.neverlands.abclient.postfilter`.
2.  **Реализовать метод `process`**:
    *   Метод будет принимать `byte[] array`.
    *   Он должен будет выполнить замену, как в C#-версии:
        ```java
        String html = Russian.Codepage.getString(array);
        int pos = html.indexOf("()");
        if (pos != -1) {
            pos += "()".length();
            html = html.substring(0, pos) + "{ return ''; }";
        }
        return Russian.Codepage.getBytes(html);
        ```
3.  **Интегрировать в `Filter.java`**: Найти в C#-коде `Filter.cs`, по какому URL вызывается `TopJs`, и добавить аналогичную проверку в `Filter.java` для вызова `TopJs.process(array)`.
