# План отладки: Проблема с отображением списка персонажей

## Проблема

Фрейм комнаты (`ch.php?lo=1`) не отображает список персонажей, хотя данные (`ChatListU`) и скрипт (`ch_list.js`) загружаются.

## Текущий статус

-   HTML-ответ для `ch.php?lo=1` перехватывается.
-   `RoomManager.java` обрабатывает этот HTML.
-   `ch_list.js` и `ChatListU` внедряются в HTML.
-   `ch_list.js` использует `innerHTML` для вставки сгенерированного списка в `<div id="char_list">`.
-   Ошибок в `logcat` нет, но список не отображается.

## Дальнейшие действия

1.  **Проверить, что `RoomManager.process` генерирует правильный HTML.**
    *   **Задача:** Добавить более детальное логирование в `RoomManager.process`, чтобы вывести финальный HTML, который отправляется в WebView.
    *   **Обоснование:** Убедиться, что сгенерированный HTML не пустой и не содержит ошибок.

2.  **Проверить, что `ch_list.js` выполняется и находит нужный `div`.**
    *   **Задача:** Добавить `alert()` или `console.log()` в `ch_list.js`, чтобы проверить:
        *   Вызывается ли функция `chatlist_build`.
        *   Что `document.getElementById('char_list')` возвращает не `null`.
        *   Что переменная `dd1 + dd2 + dd0 + ddn` содержит сгенерированный HTML.
    *   **Обоснование:** Убедиться, что скрипт работает так, как ожидается, и что проблема не в том, что он не может найти целевой `div`.

3.  **Изучить альтернативные способы вставки HTML.**
    *   **Задача:** Если `innerHTML` не работает, попробовать другие методы, например, `document.body.appendChild()`.
    *   **Обоснование:** Возможно, есть какие-то особенности работы `innerHTML` в данном контексте, которые мешают ему работать.

4.  **Сравнить с оригинальным кодом `RoomManager.cs` еще раз.**
    *   **Задача:** Внимательно перечитать `RoomManager.cs` и сравнить его с `RoomManager.java`, чтобы убедиться, что не упущена какая-то важная деталь.
    *   **Обоснование:** Возможно, есть какая-то тонкость в том, как C# версия обрабатывает HTML, которую я упустил.
