# Журнал отладки - 18.02.2026 20:06

## Проблема
Быстрые действия (нападения, свитки) не срабатывали, если в WebView открыта вкладка "Ваш персонаж" (`go=inf`), так как `FastActionManager` не находил список предметов в HTML.

## Предпринятые действия

1.  **Анализ HAR-файла (`inventory.har`)**:
    - Выявлено, что ссылки на вкладки инвентаря содержат уникальные `vcode`, которые могут отличаться от `vcode` страницы информации.
    - Пример ссылки: `main.php?get_id=56&act=10&go=inv&vcode=665b04985809fc19f6314479866a1125`.

2.  **Модификация `FastActionManager.java`**:
    - Добавлен метод `findTargetLink(html, fastId)` для интеллектуального поиска ссылок на нужные разделы инвентаря (`go=inv`, `wca=28`, `wca=27`) в текущем HTML.
    - В метод `processMainPhp` добавлена логика: если предмет не найден, но мы в `get_id=56`, выполняется автоматический JS-редирект на найденную ссылку.
    - Метод `reloadMainFrame` обновлен для использования `AppVars.VCode` при формировании начального URL, чтобы избежать ошибок сессии.

3.  **Обновление документации**:
    - Обновлен `todo_PostFilter.md` (статус `MainPhpFast.cs` изменен на `[~]`).
    - Обновлен основной `todo.md`.

## Результат
Реализован механизм автоматического переключения вкладок. Ожидается сборка v1.0.8 для тестирования.

## Выводы
Для корректной работы быстрых действий на Android необходимо обеспечивать нахождение пользователя в правильном разделе инвентаря, так как логика парсинга завязана на содержимом HTML (`w28_form`, `magicreform`). Автоматический редирект решает эту проблему прозрачно для пользователя.
