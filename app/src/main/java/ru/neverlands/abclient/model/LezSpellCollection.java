package ru.neverlands.abclient.model;

import android.content.Context;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;

/**
 * Коллекция заклинаний.
 * Портировано из LezSpellCollection.cs.
 */
public class LezSpellCollection {
    public static final Map<Integer, LezSpell> Spells = new TreeMap<>();
    public static final int[] Hits = {269, 37, 56, 205, 208, 122, 94, 144, 148};
    public static final int[] Blocks = {267, 271, 57, 258, 142, 181, 380};
    public static final int[] RestoreHp = {265, 73, 223, 84, 162, 385, 388, 320, 32};
    public static final int[] RestoreMa = {85, 33};
    public static final int[] Misc = {
            55, 49, 51, 259, 253, 254, 87, 90, 153, 197, 177,
            356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369,
            370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 381, 382, 383, 384,
            386, 387, 389, 390, 391,
            268, 272
    };

    public static final int[] Od = {
            0,0,50,90,35,50,60,30,50,60,30,50,35,80,40,85,40,85,40,85,40,100,45,
            70,70,70,130,90,90,45,60,90,30,30,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,100,
            0,200,0,0,0,100,100,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,0,0,0,0,0,0,
            0,0,0,0,100,100,0,100,0,0,150,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
            0,0,0,0,0,0,0,0,0,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,
            0,100,0,0,0,100,0,0,0,0,150,0,0,0,0,0,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,
            0,0,0,100,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,0,0,0,0,0,0,0,100,
            0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
            0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,100,0,0,0,100,200,0,0,0,0,0,90,70,90,
            70,90,70,90,70,100,100,100,70,100,70,70,100,0,30,30,30,30,30,30,30,30,
            30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
            30,30,30,30,30,50,90,30,30,30,30,30,30,30,30,30,30,30,30,0,0,0,0,30,
            30,100,100,100,80,100,100,100,100,100,100,100,50,100,100,100,100,100,
            150,50,100,100,50,50,100,100,50,50,100,30,50,100,50,50,50,50,100,30,
            50,100,50,100,30,100,50,100,90,100,50,100,100,70,100,50,100,100,100,
            50,5,5,5,5,5,100,150,50,100,140,100
    };

    public static final int[] PosType = {
            1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,
            0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,3,0,3,0,0,0,3,1,3,0,0,0,0,0,0,0,0,0,0,
            0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,3,3,0,3,0,0,3,0,0,0,1,0,0,0,0,0,0,0,
            0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,
            0,0,0,0,0,0,3,0,1,0,0,0,1,0,0,0,0,3,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,
            0,0,0,0,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,
            0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
            0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,0,0,0,0,0,3,3,2,3,3,3,3,
            3,4,4,4,4,4,5,4,4,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
            4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,6,4,4,4,4,4,4,4,4,4,4,1,1,1,1,4,4,4,1,
            1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
            3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,1,1,1,2,2,2,2,2,3,3,3,3,3,3
    };

    public static final int[] PosMana = {
            0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20,
            40, 65, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 300, 0, 0, 0, 50, 75, 100, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 150, 100, 0, 100, 0, 0, 150, 0, 0, 0, 75, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 50, 0, 0, 0, 75, 0, 0, 0, 0, 200, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 150, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 75, 0, 0, 0,
            0, 0, 0, 0, 50, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 150, 100, 0, 0, 0, 100, 200, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 50,
            10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    };

    public static void init(Context context) {
        if (!Spells.isEmpty()) return;
        try (InputStream is = context.getAssets().open("spells.txt");
             BufferedReader reader = new BufferedReader(new InputStreamReader(is, "windows-1251"))) {
            String line = reader.readLine();
            if (line != null) {
                String[] pars = line.split(",");
                for (int i = 0; i < pars.length; i++) {
                    String name = pars[i].trim();
                    if (name.startsWith("\"") && name.endsWith("\"")) {
                        name = name.substring(1, name.length() - 1);
                    }
                    Spells.put(i, new LezSpell(i, name));
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static String SpellsToString(int[] spells) {
        if (spells == null) return "";
        StringBuilder sb = new StringBuilder();
        for (int s : spells) {
            if (sb.length() > 0) sb.append(',');
            sb.append(s);
        }
        return sb.toString();
    }

    public static int[] SpellsFromString(String val) {
        if (val == null || val.isEmpty()) return new int[0];
        String[] sp = val.split(",");
        List<Integer> list = new ArrayList<>();
        for (String e : sp) {
            try {
                list.add(Integer.parseInt(e.trim()));
            } catch (NumberFormatException ignored) {}
        }
        int[] res = new int[list.size()];
        for (int i = 0; i < list.size(); i++) res[i] = list.get(i);
        return res;
    }
}
